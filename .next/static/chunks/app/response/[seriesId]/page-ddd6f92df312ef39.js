(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[783],{9831:function(e,t,a){Promise.resolve().then(a.bind(a,3002))},3002:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var r=a(7437),s=a(7122),n=a.n(s),o=a(1997),i=a.n(o),l=a(2126),c=a(2265),d=a(8726),u=a(7650),p=a(762),f=a(3237),m=a(6463),h=a(1987),g=a(994),x=a(2800);async function y(){let e=(0,m.useRouter)(),[{history:t,loading:a},s]=(0,c.useState)({history:[],loading:!1}),{seriesId:o}=(0,m.useParams)();(0,c.useEffect)(()=>{(async()=>{if(!a){s(e=>({...e,loading:!0}));try{var t;let a=null!==(t=window.location.pathname.split("/").pop())&&void 0!==t?t:o,r=localStorage.getItem("userId"),n=(await l.Z.get("/api/series/".concat(a,"?userId=").concat(r))).data;if(n.new){e.replace("/response?seriesId=".concat(n.data.id));return}let i=n.data.history;"string"==typeof i&&(i=JSON.parse(i));let c=i.filter(e=>"user"!==e.role&&"system"!==e.role&&"You are a film scenario creation AI assistant."!==e.content);s({history:c,loading:!1})}catch(e){s(e=>({...e,loading:!1})),console.error(e),d.ZP.error("Failed to fetch data")}}})()},[]);let y=async()=>{s(e=>({...e,loading:!0}));try{var e;let a=null!==(e=window.location.pathname.split("/").pop())&&void 0!==e?e:o;console.log("create new episode",o);let r=(await (0,x.k)({history:t,seriesId:a})).series.history.filter(e=>"user"!==e.role&&"system"!==e.role&&"You are a film scenario creation AI assistant."!==e.content);s(e=>({...e,history:r,loading:!1})),d.ZP.success("New episode created")}catch(e){console.error(e),s(e=>({...e,loading:!1}))}};return(0,r.jsxs)("main",{className:"flex min-h-screen flex-col items-start flex-start mb-[2rem] gap-5",children:[(0,r.jsx)("header",{id:"header",className:"h-[90px] bg-[#000] text-lg pt-[3rem] w-full text-center text-white relative",children:(0,r.jsx)(u.Z,{h2:!0,className:"relative z-10 px-4",children:"Here you go..."})}),(0,r.jsxs)("div",{className:"flex flex-col gap-5 px-4 xl:max-w-[1200px] m-auto",children:[t.map(async(e,t)=>{let a=await (0,h.C)(e.content),s=(0,g.S)(a);return(0,r.jsxs)(p.Z,{className:"p-4 relative z-10 my-2",children:[(0,r.jsxs)("h3",{className:"font-bold",children:["episode ",t+1]}),(0,r.jsx)("p",{className:"text-lg ".concat(n().className," ").concat(i().episode),dangerouslySetInnerHTML:{__html:s}})]},t)}),(0,r.jsx)(f.Z,{loading:a,onPointerEnterCapture:null,type:"secondary",onClick:y,className:"rounded-lg p-2 bg-indigo-600 text-zinc-100 active:scale-125 transition-all hover:bg-indigo-800",placeholder:void 0,onPointerLeaveCapture:void 0,children:"Generate new episode"})]})]})}},2800:function(e,t,a){"use strict";a.d(t,{g:function(){return n},k:function(){return s}});var r=a(2126);let s=async e=>{let{history:t,seriesId:a}=e,s=[...t,{role:"user",content:"Create new episode"}];return(await r.Z.post("/api/series/".concat(a),{history:s})).data},n=async e=>{let{userId:t}=e;try{return(await r.Z.get("/api/series?userId="+t)).data.data}catch(e){return console.error(e),[]}}},1997:function(e){e.exports={episode:"page_episode__1xfcy"}},7122:function(e){e.exports={style:{fontFamily:"'__Courier_Prime_ebc7f1', '__Courier_Prime_Fallback_ebc7f1'",fontStyle:"normal"},className:"__className_ebc7f1"}}},function(e){e.O(0,[64,643,919,283,726,826,6,294,971,23,744],function(){return e(e.s=9831)}),_N_E=e.O()}]);